# Scripts Folder

*Currently a work-in-progress*

This folder contains a variety of scripts for periodical issue segmentation and modeling. There are currently three subfolders:

- **`archived_scripts`**: Contains previously used scripts that are no longer in use.
- **`segmentation_scripts`**: Contains scripts for periodical issue segmentation.
- **`wavelet_scripts`**: Contains scripts for wavelet modeling.

In this main folder, we have two scripts:

- **`utils.py`**: Contains utility functions used by other scripts in this project. Below is a detailed breakdown of the functions included:

| Function                | Description                                                                                     | Parameters                                                                                                                                                                                                                                                                                                                                                                             | Returns                                    |
|-------------------------|-------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
| `save_chart`            | Saves an Altair chart as a `.png` or `.svg` file.                                               | `chart` (Altair chart), `filename` (str, path to save), `scale_factor` (float, resolution scaling factor, default `2.0`)                                                                                                                                                                                                                         | None                                       |
| `set_data_directory_path` | Sets a path to the data directory and saves it as a persistent variable.                       | `path` (str, directory path to set)                                                                                                                                                                                                                                                                                                             | None                                       |
| `get_data_directory_path` | Retrieves the currently set data directory path.                                              | None                                                                                                                                                                                                                                                                                                                                           | `str` (directory path)                     |
| `read_csv_file`         | Reads a CSV file into a Pandas DataFrame with support for multiple encodings and error handling. | `file_name` (str, CSV file name), `directory` (Optional[str], directory path, default `None`), `encodings` (Optional[List[str]], list of encodings, default `['utf-8', 'latin1', 'iso-8859-1', 'utf-8-sig']`), `error_bad_lines` (bool, skip bad lines, default `False`)                                                                           | Pandas DataFrame or `None`                 |
| `generate_table`        | Displays a Pandas DataFrame as a styled table in the console.                                   | `df` (Pandas DataFrame), `table_title` (str, title for the table)                                                                                                                                                                                                                                                                               | None                                       |
| `filter_integers`       | Checks if a given string token represents an integer.                                           | `token` (str, token to check)                                                                                                                                                                                                                                                                                                                   | `bool` (`True` if integer, else `False`)   |
| `calculate_digit_coverage` | Calculates the number of digits in rows of a DataFrame.                                      | `rows` (Pandas DataFrame, with column `implied_zero`)                                                                                                                                                                                                                                                                                          | `int` (number of digits)                   |
| `clean_digits`          | Cleans and filters digit tokens while retaining non-digit pages.                                | `df` (Pandas DataFrame), `filter_greater_than_numbers` (bool), `filter_implied_zeroes` (bool), `preidentified_periodical` (bool)                                                                                                                                                                                                                 | Cleaned Pandas DataFrame                   |
| `process_file`          | Handles file reading, token expansion, cleaning, while retaining file pages for issue segmentation.                        | `file_path` (str, path to CSV), `is_preidentified_periodical` (bool), `should_filter_greater_than_numbers` (bool), `should_filter_implied_zeroes` (bool)                                                                                                                                                                                        | Expanded DataFrame, digit subset, grouping |


- **`generate_annotated_ht_volumes.py`**: A script for combining annotated volumes with the original HT volumes and processing them for segmentation. Below is a detailed breakdown of its functionality:

| Function                   | Description                                                                                                                                                               | Parameters                                                                                                                                                                                                                                                                                                       | Returns                     |
|----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|
| `transform_annotated_dates` | Transforms metadata dates into a format that can be merged.                                                                                                              | `rows` (pd.DataFrame): DataFrame rows to transform.                                                                                                                                                                                                                                                              | Transformed `pd.DataFrame`. |
| `clean_annotated_df`       | Cleans and normalizes dates in manually annotated datasets.                                                                                                               | `annotated_df` (pd.DataFrame): Annotated dataset to clean and normalize.                                                                                                                                                                                                                                         | Cleaned `pd.DataFrame`.     |
| `cut_vols`                 | Filters volume rows based on page type and removes duplicates for optimal issue segmentation.                                                                              | `rows` (pd.DataFrame): Rows to filter.                                                                                                                                                                                                                                                                           | Filtered `pd.DataFrame`.    |
| `clean_arab_observer_df`   | Cleans and normalizes dates in the Arab Observer dataset.                                                                                                                 | `arabobserver_df` (pd.DataFrame): Dataset to clean and normalize.                                                                                                                                                                                                                                                | Cleaned `pd.DataFrame`.     |
| `clean_afro_asian_df`      | Cleans and normalizes dates in the Afro-Asian dataset.                                                                                                                    | `afroasian_df` (pd.DataFrame): Dataset to clean and normalize.                                                                                                                                                                                                                                                   | Cleaned `pd.DataFrame`.     |
| `clean_annotated_ht_volume` | Processes and cleans an annotated HathiTrust volume.                                                                                                                     | `annotated_ht_df` (pd.DataFrame): Annotated HathiTrust volume to clean. <br> `volume_type` (str): Type of volume, either `grouped` or `individual`.                                                                                                                                                              | Cleaned `pd.DataFrame`.     |
| `merge_datasets`           | Merges extracted feature datasets with annotated datasets and optionally saves the merged dataset.                                                                         | `annotated_df` (pd.DataFrame): Annotated dataset. <br> `preidentified_periodicals_df` (pd.DataFrame): Preidentified periodicals dataset. <br> `data_directory_path` (str): Path to data directory. <br> `cut_volumes` (bool): Whether to filter rows. <br> `rerun_code` (bool): Whether to rerun processing. <br> `save_to_file` (bool): Whether to save the dataset. <br> `volume_type` (str): Type of volume (`grouped` or `individual`). | None.                      |
| `map_annotated_ht_volumes` | Maps annotated HathiTrust volumes to preidentified periodicals, merges datasets, and processes volumes with optional filtering and saving.                                  | `data_directory_path` (str): Path to the data directory. <br> `rerun_code` (bool): Whether to rerun processing. <br> `cut_volumes` (bool): Whether to filter volumes. <br> `save_to_file` (bool): Whether to save processed datasets. <br> `volume_type` (str): Volume type (`grouped` or `individual`).                         | None.                      |